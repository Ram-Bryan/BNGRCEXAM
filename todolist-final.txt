# ============================================================
#  TODOLIST FINALE — Takalo Takalo (Plateforme d'échange)
#  Récapitulatif de toutes les tâches réalisées
# ============================================================

# FORMAT: [x] Tâche — Fichier(s) — Temps estimé
# [x] = terminé, [ ] = non fait

# ============================================================
# 1. ANALYSE & ARCHITECTURE (Estimé: 30 min)
# ============================================================
[x] Analyser tous les fichiers existants (30+ fichiers)               — Toute la codebase               — 20 min
[x] Identifier la structure MVC Flight PHP existante                   — bootstrap.php, routes.php       — 5 min
[x] Comprendre le schéma de la base de données                        — data/*.sql                       — 5 min

# ============================================================
# 2. BASE DE DONNÉES — Vues SQL (Estimé: 15 min)
# ============================================================
[x] Créer les vues SQL (v_objets, v_echanges, v_echange_objets,       — data/20260213-01-views.sql       — 10 min
    v_historique_objet, v_photo_principale)
[x] Exécuter la migration SQL sur la base                              — MySQL CLI                        — 5 min

# ============================================================
# 3. MODÈLES (Estimé: 40 min)
# ============================================================
[x] Créer modèle EchangeObjet (CRUD, findByEchangeId via vue)         — app/models/EchangeObjet.php      — 10 min
[x] Créer modèle HistoriqueProprietaire (create, findByObjetId vue)    — app/models/HistoriqueProprietaire.php — 10 min
[x] Modifier modèle Objet (buildFromRow, getAll, getAllByUser,         — app/models/Objet.php             — 10 min
    getAllByUserDisponible, search AJAX, countAll)
[x] Modifier modèle Echange (accepter/refuser/annuler transactions,   — app/models/Echange.php           — 5 min
    getByUser, getRecent, countAll via vues SQL)
[x] Modifier modèle Categorie (ajout countAll)                        — app/models/Categorie.php         — 5 min

# ============================================================
# 4. CONTRÔLEURS (Estimé: 45 min)
# ============================================================
[x] Créer ObjetController (listObjets, searchObjets AJAX,             — app/controllers/ObjetController.php    — 15 min
    showObjet, mesObjets, showAjoutObjet, createObjet avec
    transaction + upload photos + historique, showEditObjet,
    updateObjet, deleteObjet)
[x] Créer EchangeController (mesEchanges, proposerEchange             — app/controllers/EchangeController.php  — 15 min
    transaction, accepterEchange, refuserEchange,
    annulerEchange, detailEchange JSON API)
[x] Créer CategorieController (showCategories, getAll JSON,           — app/controllers/CategorieController.php — 10 min
    createCategorie, updateCategorie, deleteCategorie,
    checkAdmin)
[x] Modifier BackofficeController (constructor, checkAdmin,           — app/controllers/BackofficeController.php — 5 min
    showStats avec stats + recentEchanges, showDashboard
    avec nbUsers/nbObjets/nbEchanges/nbCategories)
[x] Modifier HomeController (session_start, isLoggedIn,               — app/controllers/HomeController.php      — 5 min
    passer user à la vue)

# ============================================================
# 5. ROUTES (Estimé: 10 min)
# ============================================================
[x] Ajouter routes objets (GET/POST CRUD + search API)                — app/routes.php                   — 5 min
[x] Ajouter routes échanges (proposer/accepter/refuser/annuler/       — app/routes.php                   — 2 min
    detail)
[x] Ajouter routes backoffice (stats, categories CRUD)                — app/routes.php                   — 2 min
[x] Corriger ordre des routes (/objets/ajout AVANT /objets/@id)       — app/routes.php                   — 1 min

# ============================================================
# 6. VUES FRONTOFFICE (Estimé: 60 min)
# ============================================================
[x] Créer objets/list.php (recherche + dropdown catégorie +           — app/views/objets/list.php         — 15 min
    grille objets + hover icons)
[x] Créer objets/detail.php (photos, infos, modal échange avec        — app/views/objets/detail.php       — 15 min
    dropdown mes objets, tableau historique propriétaires)
[x] Créer objets/mes-objets.php (liste perso + boutons                — app/views/objets/mes-objets.php   — 10 min
    voir/modifier/supprimer)
[x] Créer objets/ajout.php (formulaire avec titre, description,       — app/views/objets/ajout.php        — 10 min
    catégorie, état, prix, upload multi-photos + preview radio)
[x] Créer objets/edit.php (formulaire pré-rempli + photos             — app/views/objets/edit.php         — 10 min
    actuelles + remplacement optionnel)
[x] Créer echanges/list.php (tableau échanges, badges statut,         — app/views/echanges/list.php       — 15 min
    boutons action accept/refuser/annuler, modal détail)

# ============================================================
# 7. VUES BACKOFFICE (Estimé: 30 min)
# ============================================================
[x] Créer backoffice/sidebar.php (navigation partagée:                — app/views/backoffice/sidebar.php  — 5 min
    Dashboard, Stats, Catégories, Retour site, Déconnexion)
[x] Modifier backoffice/home.php (stats dynamiques + cards             — app/views/backoffice/home.php     — 10 min
    navigation + include sidebar)
[x] Créer backoffice/stats.php (4 cards stats + tableau               — app/views/backoffice/stats.php    — 10 min
    derniers échanges)
[x] Créer backoffice/categories.php (CRUD table + modal               — app/views/backoffice/categories.php — 10 min
    ajout/édition + boutons supprimer)

# ============================================================
# 8. COMPOSANTS PARTAGÉS (Estimé: 15 min)
# ============================================================
[x] Modifier header.php (liens Objets, Mes Objets, Échanges           — app/views/includes/header.php    — 10 min
    pour connectés, nom utilisateur)
[x] Modifier footer.php (liens Takalo, routes correctes)              — app/views/includes/footer.php    — 5 min
[x] Modifier index.php (liens différents quand connecté:              — app/views/index.php              — 5 min
    Ajouter objet, Mes échanges, liens vers détail objets)

# ============================================================
# 9. JAVASCRIPT / AJAX (Estimé: 30 min)
# ============================================================
[x] Créer objets.js (recherche AJAX temps réel debounce 400ms,        — public/assets/js/objets.js       — 10 min
    preview photos + radio principale, formulaires
    ajout/modif/suppression AJAX)
[x] Créer echanges.js (proposer échange via modal,                    — public/assets/js/echanges.js     — 10 min
    accepter/refuser/annuler AJAX, modal détail dynamique)
[x] Créer backoffice.js (CRUD catégories AJAX: ajout/modif            — public/assets/js/backoffice.js   — 10 min
    via modal, suppression avec confirm)

# ============================================================
# 10. CORRECTIONS & OPTIMISATIONS (Estimé: 10 min)
# ============================================================
[x] Ajouter meta base-url dans toutes les vues AJAX                   — 6 fichiers vues                  — 5 min
[x] Corriger requête PDO IN (split en 2 requêtes)                     — EchangeController.php            — 2 min
[x] Corriger ordre routes pour éviter capture @id sur 'ajout'         — routes.php                       — 3 min

# ============================================================
# RÉSUMÉ
# ============================================================
# Fichiers créés: 12
#   - data/20260213-01-views.sql
#   - app/models/EchangeObjet.php
#   - app/models/HistoriqueProprietaire.php
#   - app/controllers/ObjetController.php
#   - app/controllers/EchangeController.php
#   - app/controllers/CategorieController.php
#   - app/views/objets/list.php, detail.php, mes-objets.php, ajout.php, edit.php
#   - app/views/echanges/list.php
#   - app/views/backoffice/sidebar.php, stats.php, categories.php
#   - public/assets/js/objets.js, echanges.js, backoffice.js
#
# Fichiers modifiés: 9
#   - app/models/Objet.php, Echange.php, Categorie.php
#   - app/controllers/BackofficeController.php, HomeController.php
#   - app/routes.php
#   - app/views/includes/header.php, footer.php
#   - app/views/index.php
#   - app/views/backoffice/home.php
#
# TEMPS TOTAL ESTIMÉ: ~285 minutes (~4h45)
# ============================================================
